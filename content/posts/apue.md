---
title: "Apue"
date: 2021-02-05T11:01:09+08:00
draft: true
---

## 11. 线程

### 线程概念

线程是操作系统能够进行运算调度的最小单位，每个线程都包含有执行环境所必需的信息，其中包括进程中标识线程的线程 ID

、一组寄存器值、线程栈、调度优先级和策略、信号屏蔽字、errno 变量以及线程私有数据。一个进程的所有信息对该进程的所有线程都是共享的，包括可执行程序的代码、全局内存和堆内存、栈以及文件描述符。

### 线程标识

每个进程都有一个进程 id，同样的，每个线程都有一个线程 id。与进程不同，进程 id 在整个系统中是唯一的，但是线程 id 不同，线程 id 只有在它所属的进程上下文中才有意义。

linux 中使用指向线程数据结构的指针值作为线程 id。



## 14. 高级 I/O

### 非阻塞式 I/O

非阻塞式 I/O 使我们可以发出 open、read 和 write 这样的 I/O 操作，并使这些操作不会永久阻塞。



### 记录锁（字节范围锁）fcntl

当一个进程正在读取或修改一个文件的某个区域时，可以阻止其他程序读取或修改这个区域。

对于记录锁，fcntl 的 cmd 可以是：F_GETLK、F_SETLK 和 F_SETLKW，第三个参数是一个指向 flock 结构的指针。